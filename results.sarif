{"$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json", "version": "2.1.0", "runs": [{"tool": {"driver": {"name": "Checkov", "version": "3.2.74", "informationUri": "https://checkov.io", "rules": [{"id": "CKV_DOCKER_4", "name": "Ensure that COPY is used instead of ADD in Dockerfiles", "shortDescription": {"text": "Ensure that COPY is used instead of ADD in Dockerfiles"}, "fullDescription": {"text": "Ensure that COPY is used instead of ADD in Dockerfiles"}, "help": {"text": "Ensure that COPY is used instead of ADD in Dockerfiles\nResource: Dockerfile.ADD"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-copy-is-used-instead-of-add-in-dockerfiles"}, {"id": "CKV_DOCKER_3", "name": "Ensure that a user for the container has been created", "shortDescription": {"text": "Ensure that a user for the container has been created"}, "fullDescription": {"text": "Ensure that a user for the container has been created"}, "help": {"text": "Ensure that a user for the container has been created\nResource: Dockerfile."}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-a-user-for-the-container-has-been-created"}, {"id": "CKV_DOCKER_2", "name": "Ensure that HEALTHCHECK instructions have been added to container images", "shortDescription": {"text": "Ensure that HEALTHCHECK instructions have been added to container images"}, "fullDescription": {"text": "Ensure that HEALTHCHECK instructions have been added to container images"}, "help": {"text": "Ensure that HEALTHCHECK instructions have been added to container images\nResource: Dockerfile."}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-healthcheck-instructions-have-been-added-to-container-images"}], "organization": "bridgecrew"}}, "results": [{"ruleId": "CKV_DOCKER_4", "ruleIndex": 0, "level": "error", "attachments": [], "message": {"text": "Ensure that COPY is used instead of ADD in Dockerfiles"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "Dockerfile"}, "region": {"startLine": 21, "endLine": 21, "snippet": {"text": "ADD [\"index.html\",\"/var/www/html/\"]\n"}}}}]}, {"ruleId": "CKV_DOCKER_3", "ruleIndex": 1, "level": "error", "attachments": [], "message": {"text": "Ensure that a user for the container has been created"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "Dockerfile"}, "region": {"startLine": 1, "endLine": 24, "snippet": {"text": "FROM ubuntu:xenial-20210429\n\n# Install apache, PHP, and supplimentary programs. openssh-server, curl, and lynx-cur are for debugging the container.\nRUN apt-get update && apt-get install -y apache2 php7.0 php7.0-mysql libapache2-mod-php7.0 curl lynx-common\n\n# Enable apache mods.\nRUN a2enmod php7.0\nRUN a2enmod rewrite\n\n\n# Manually set up the apache environment variables\nENV APACHE_RUN_USER www-data\nENV APACHE_RUN_GROUP www-data\nENV APACHE_LOG_DIR /var/log/apache2\nENV APACHE_LOCK_DIR /var/lock/apache2\n\n# Expose apache.\nEXPOSE 80\n\n# Copy this repo into place.\nADD [\"index.html\",\"/var/www/html/\"]\n\n# Update the default apache site with the config we created.\nENTRYPOINT [\"/usr/sbin/apache2ctl\", \"-D\", \"FOREGROUND\"]"}}}}]}, {"ruleId": "CKV_DOCKER_2", "ruleIndex": 2, "level": "error", "attachments": [], "message": {"text": "Ensure that HEALTHCHECK instructions have been added to container images"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "Dockerfile"}, "region": {"startLine": 1, "endLine": 24, "snippet": {"text": "FROM ubuntu:xenial-20210429\n\n# Install apache, PHP, and supplimentary programs. openssh-server, curl, and lynx-cur are for debugging the container.\nRUN apt-get update && apt-get install -y apache2 php7.0 php7.0-mysql libapache2-mod-php7.0 curl lynx-common\n\n# Enable apache mods.\nRUN a2enmod php7.0\nRUN a2enmod rewrite\n\n\n# Manually set up the apache environment variables\nENV APACHE_RUN_USER www-data\nENV APACHE_RUN_GROUP www-data\nENV APACHE_LOG_DIR /var/log/apache2\nENV APACHE_LOCK_DIR /var/lock/apache2\n\n# Expose apache.\nEXPOSE 80\n\n# Copy this repo into place.\nADD [\"index.html\",\"/var/www/html/\"]\n\n# Update the default apache site with the config we created.\nENTRYPOINT [\"/usr/sbin/apache2ctl\", \"-D\", \"FOREGROUND\"]"}}}}]}]}]}